import*as e from"react";import{PrimeReactContext as n,localeOption as t}from"primereact/api";import{ComponentBase as r,useHandleStyle as o}from"primereact/componentbase";import{useMergeProps as a}from"primereact/hooks";import{SearchIcon as l}from"primereact/icons/search";import{SpinnerIcon as i}from"primereact/icons/spinner";import{classNames as c,DomHandler as d,ObjectUtils as s,IconUtils as u}from"primereact/utils";import{CheckIcon as p}from"primereact/icons/check";import{ChevronDownIcon as f}from"primereact/icons/chevrondown";import{ChevronRightIcon as g}from"primereact/icons/chevronright";import{MinusIcon as m}from"primereact/icons/minus";import{Ripple as y}from"primereact/ripple";function h(){return h=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},h.apply(this,arguments)}function v(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function b(e){if(Array.isArray(e))return v(e)}function x(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function S(e,n){if(e){if("string"==typeof e)return v(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?v(e,n):void 0}}function E(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e){return b(e)||x(e)||S(e)||E()}function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function I(e,n){if("object"!==C(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function D(e){var n=I(e,"string");return"symbol"===C(n)?n:String(n)}function O(e,n,t){return(n=D(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function w(e){if(Array.isArray(e))return e}function T(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,a,l,i=[],c=!0,d=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=a.call(t)).done)&&(i.push(r.value),i.length!==n);c=!0);}catch(e){d=!0,o=e}finally{try{if(!c&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(d)throw o}}return i}}function N(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,n){return w(e)||T(e,n)||S(e,n)||N()}var M=r.extend({defaultProps:{__TYPE:"Tree",__parentMetadata:null,id:null,value:null,ariaLabel:null,ariaLabelledBy:null,checkboxIcon:null,className:null,collapseIcon:null,contentClassName:null,contentStyle:null,contextMenuSelectionKey:null,disabled:!1,dragdropScope:null,emptyMessage:null,expandIcon:null,expandedKeys:null,filter:!1,filterBy:"label",filterIcon:null,filterLocale:void 0,filterMode:"lenient",filterPlaceholder:null,filterTemplate:null,filterValue:null,footer:null,header:null,level:0,loading:!1,loadingIcon:null,metaKeySelection:!1,nodeTemplate:null,onCollapse:null,onContextMenu:null,onContextMenuSelectionChange:null,onDragDrop:null,onExpand:null,onFilterValueChange:null,onNodeClick:null,onNodeDoubleClick:null,onSelect:null,onSelectionChange:null,onToggle:null,onUnselect:null,propagateSelectionDown:!0,propagateSelectionUp:!0,selectionKeys:null,selectionMode:null,showHeader:!0,style:null,togglerTemplate:null,children:void 0},css:{classes:{container:"p-tree-container",loadingIcon:"p-tree-loading-icon",loadingOverlay:"p-tree-loading-overlay p-component-overlay",searchIcon:"p-tree-filter-icon",emptyMessage:"p-treenode p-tree-empty-message",filterContainer:"p-tree-filter-container",input:"p-tree-filter p-inputtext p-component",header:"p-tree-header",footer:"p-tree-footer",root:function(e){var n=e.props;return c("p-tree p-component",{"p-tree-selectable":n.selectionMode,"p-tree-loading":n.loading,"p-disabled":n.disabled})},label:"p-treenode-label",checkboxIcon:"p-checkbox-icon p-c",checkboxContainer:"p-checkbox p-component",checkbox:function(e){return c("p-checkbox-box",{"p-highlight":e.checked,"p-indeterminate":e.partialChecked,"p-disabled":e.nodeProps.disabled})},nodeIcon:"p-treenode-icon",togglerIcon:"p-tree-toggler-icon",toggler:"p-tree-toggler p-link",droppoint:"p-treenode-droppoint",content:function(e){var n=e.nodeProps,t=e.checked,r=e.selected;return c("p-treenode-content",{"p-treenode-selectable":n.selectionMode&&!1!==n.node.selectable,"p-highlight":(0,e.isCheckboxSelectionMode)()?t:r,"p-highlight-contextmenu":n.contextMenuSelectionKey&&n.contextMenuSelectionKey===n.node.key,"p-disabled":n.disabled})},subgroup:"p-treenode-children",node:function(e){return c("p-treenode",{"p-treenode-leaf":e.isLeaf})}},styles:"\n@layer primereact {\n    .p-tree-container {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n        overflow: auto;\n    }\n\n    .p-treenode-children {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n    }\n\n    .p-treenode-selectable {\n        cursor: pointer;\n        user-select: none;\n    }\n\n    .p-tree-toggler {\n        cursor: pointer;\n        user-select: none;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n        overflow: hidden;\n        position: relative;\n    }\n\n    .p-treenode-leaf > .p-treenode-content .p-tree-toggler {\n        visibility: hidden;\n    }\n\n    .p-treenode-content {\n        display: flex;\n        align-items: center;\n    }\n\n    .p-tree-filter {\n        width: 100%;\n    }\n\n    .p-tree-filter-container {\n        position: relative;\n        display: block;\n        width: 100%;\n    }\n\n    .p-tree-filter-icon {\n        position: absolute;\n        top: 50%;\n        margin-top: -.5rem;\n    }\n\n    .p-tree-loading {\n        position: relative;\n        min-height: 4rem;\n    }\n\n    .p-tree .p-tree-loading-overlay {\n        position: absolute;\n        z-index: 1;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n}\n"}});function P(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=j(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return l=e.done,e},e:function(e){i=!0,a=e},f:function(){try{l||null==t.return||t.return()}finally{if(i)throw a}}}}function j(e,n){if(e){if("string"==typeof e)return A(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?A(e,n):void 0}}function A(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function U(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?U(Object(t),!0).forEach((function(n){O(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):U(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var R=e.memo((function(n){var t,r,o,l,i,h,v,b=e.useRef(null),x=e.useRef(null),S=e.useRef(!1),E=a(),C=n.isNodeLeaf(n.node),I=n.node.label,D=!!n.expandedKeys&&void 0!==n.expandedKeys[n.node.key]||n.node.expanded,w=n.ptm,T=n.cx,N=function(e){return w(e,{hostName:n.hostName,context:{selected:!ce()&&re(),expanded:D||!1,checked:!!ce()&&oe(),isLeaf:C}})},K=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.expandedKeys?L({},n.expandedKeys):{};r[n.node.key]=!0,n.onToggle({originalEvent:e,value:r,navigateFocusToChild:t}),A(e,!0)},M=function(e){var t=L({},n.expandedKeys);delete t[n.node.key],n.onToggle({originalEvent:e,value:t}),A(e,!1)},j=function(e){n.disabled||(D?M(e):K(e,!1),e.preventDefault(),e.stopPropagation())},A=function(e,t){t?n.onExpand&&n.onExpand({originalEvent:e,node:n.node}):n.onCollapse&&n.onCollapse({originalEvent:e,node:n.node})},U=function e(n){var t=J(n);return t?t.nextElementSibling||e(t):null},F=function e(n){var t=n.children[1];return t?e(t.children[t.children.length-1]):n},J=function(e){var n=e.parentElement.parentElement;return d.hasClass(n,"p-treenode")?n:null},X=function(e){n.onClick&&n.onClick({originalEvent:e,node:n.node});var t=e.target.nodeName;if(!n.disabled&&"INPUT"!==t&&"BUTTON"!==t&&"A"!==t&&!d.hasClass(e.target,"p-clickable")){if(n.selectionMode&&!1!==n.node.selectable){var r;if(ce()){var o=oe();r=n.selectionKeys?L({},n.selectionKeys):{},o?(n.propagateSelectionDown?te(n.node,!1,r):delete r[n.node.key],n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp({originalEvent:e,check:!1,selectionKeys:r}),n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(n.propagateSelectionDown?te(n.node,!0,r):r[n.node.key]={checked:!0},n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp({originalEvent:e,check:!0,selectionKeys:r}),n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}else{var a=re();if(!S.current&&n.metaKeySelection){var l=e.metaKey||e.ctrlKey;a&&l?(le()?r=null:delete(r=L({},n.selectionKeys))[n.node.key],n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(le()?r=n.node.key:ie()&&((r=l&&n.selectionKeys?L({},n.selectionKeys):{})[n.node.key]=!0),n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}else le()?a?(r=null,n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(r=n.node.key,n.onSelect&&n.onSelect({originalEvent:e,node:n.node})):a?(delete(r=L({},n.selectionKeys))[n.node.key],n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):((r=n.selectionKeys?L({},n.selectionKeys):{})[n.node.key]=!0,n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}n.onSelectionChange&&n.onSelectionChange({originalEvent:e,value:r})}S.current=!1}},B=function(e){n.onDoubleClick&&n.onDoubleClick({originalEvent:e,node:n.node})},V=function(e){n.disabled||(d.clearSelection(),n.onContextMenuSelectionChange&&n.onContextMenuSelectionChange({originalEvent:e,value:n.node.key}),n.onContextMenu&&n.onContextMenu({originalEvent:e,node:n.node}))},_=function(e){if(ae(e))switch(e.code){case"Tab":G();break;case"ArrowDown":H(e);break;case"ArrowUp":$(e);break;case"ArrowRight":z(e);break;case"ArrowLeft":Y(e);break;case"Enter":case"NumpadEnter":case"Space":q(e)}},H=function(e){var n="toggler"===e.target.getAttribute("data-pc-section")?e.target.closest('[role="treeitem"]'):e.target,t=n.children[1];if(t)Z(n,t.children[0]);else if(n.nextElementSibling)Z(n,n.nextElementSibling);else{var r=U(n);r&&Z(n,r)}e.preventDefault()},$=function(e){var n=e.target;if(n.previousElementSibling)Z(n,n.previousElementSibling,F(n.previousElementSibling));else{var t=J(n);t&&Z(n,t)}e.preventDefault()},z=function(e){C||D||(e.currentTarget.tabIndex=-1,K(e,!0))},Y=function(e){var t=d.findSingle(e.currentTarget,'[data-pc-section="toggler"]');if(0===n.level&&!D)return!1;if(D&&!C)return t.click(),!1;var r=ee(e.currentTarget);r&&Z(e.currentTarget,r)},q=function(e){W(e,S.current),X(e),e.preventDefault()},G=function(){Q()},Q=function(){var e=d.find(b.current.closest('[data-pc-section="container"]'),'[role="treeitem"]'),n=k(e).some((function(e){return"true"===e.getAttribute("aria-selected")||"true"===e.getAttribute("aria-checked")}));if(k(e).forEach((function(e){e.tabIndex=-1})),n){var t=k(e).filter((function(e){return"true"===e.getAttribute("aria-selected")||"true"===e.getAttribute("aria-checked")}));t[0].tabIndex=0}else k(e)[0].tabIndex=0},W=function(e,t){if(null!==n.selectionMode){var r=k(d.find(x.current.parentElement,'[role="treeitem"]'));e.currentTarget.tabIndex=!1===t?-1:0,r.every((function(e){return-1===e.tabIndex}))&&(r[0].tabIndex=0)}},Z=function(e,n,t){var r;e.tabIndex="-1",n.tabIndex="0",(r=t||n)&&r.focus()},ee=function e(n){var t=n.closest("ul").closest("li");if(t){var r=d.findSingle(t,"button");return r&&"hidden"!==r.style.visibility?t:e(n.previousElementSibling)}return null},ne=function(e){var t,r=e.check,o=e.selectionKeys,a=P(n.node.children);try{for(a.s();!(t=a.n()).done;){var l=t.value;o[l.key]&&o[l.key].checked&&0}}catch(e){a.e(e)}finally{a.f()}var i=n.node.key,c=s.findChildrenByKey(n.originalOptions,i),d=c.some((function(e){return e.key in o})),u=c.every((function(e){return e.key in o&&o[e.key].checked}));d&&!u?o[i]={checked:!1,partialChecked:!0}:u?o[i]={checked:!0,partialChecked:!1}:r?o[i]={checked:!1,partialChecked:!1}:delete o[i],n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp(e)},te=function e(n,t,r){if(t?r[n.key]={checked:!0,partialChecked:!1}:delete r[n.key],n.children&&n.children.length)for(var o=0;o<n.children.length;o++)e(n.children[o],t,r)},re=function(){return!(!n.selectionMode||!n.selectionKeys)&&(le()?n.selectionKeys===n.node.key:void 0!==n.selectionKeys[n.node.key])},oe=function(){return!!n.selectionKeys&&(n.selectionKeys[n.node.key]&&n.selectionKeys[n.node.key].checked)||!1},ae=function(e){return e.currentTarget&&(e.currentTarget.isSameNode(e.target)||e.currentTarget.isSameNode(e.target.closest('[role="treeitem"]')))},le=function(){return n.selectionMode&&"single"===n.selectionMode},ie=function(){return n.selectionMode&&"multiple"===n.selectionMode},ce=function(){return n.selectionMode&&"checkbox"===n.selectionMode},de=function(){S.current=!0},se=function(e,t){(e.preventDefault(),!1!==n.node.droppable)&&(d.removeClass(e.target,"p-treenode-droppoint-active"),n.onDropPoint&&n.onDropPoint({originalEvent:e,path:n.path,index:-1===t?n.index:n.index+1,position:t}))},ue=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&(e.dataTransfer.dropEffect="move",e.preventDefault())},pe=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&d.addClass(e.target,"p-treenode-droppoint-active")},fe=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&d.removeClass(e.target,"p-treenode-droppoint-active")},ge=function(e){n.dragdropScope&&!1!==n.node.droppable&&(d.removeClass(b.current,"p-treenode-dragover"),e.preventDefault(),e.stopPropagation(),n.onDrop&&n.onDrop({originalEvent:e,path:n.path,index:n.index}))},me=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable&&(e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation())},ye=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable&&d.addClass(b.current,"p-treenode-dragover")},he=function(e){if(e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable){var t=e.currentTarget.getBoundingClientRect();(e.nativeEvent.x>t.left+t.width||e.nativeEvent.x<t.left||e.nativeEvent.y>=Math.floor(t.top+t.height)||e.nativeEvent.y<t.top)&&d.removeClass(b.current,"p-treenode-dragover")}},ve=function(e){e.dataTransfer.setData("text",n.dragdropScope),e.dataTransfer.setData(n.dragdropScope,n.dragdropScope),n.onDragStart&&n.onDragStart({originalEvent:e,path:n.path,index:n.index})},be=function(e){n.onDragEnd&&n.onDragEnd({originalEvent:e})},xe=function(){var t=E({className:T("label")},N("label")),r=e.createElement("span",t,I);n.nodeTemplate&&(r=s.getJSXElement(n.nodeTemplate,n.node,{onTogglerClick:j,className:"p-treenode-label",element:r,props:n,expanded:D}));return r},Se=function(){if(ce()&&!1!==n.node.selectable){var t=oe(),r=!!n.selectionKeys&&n.selectionKeys[n.node.key]&&n.selectionKeys[n.node.key].partialChecked,o=E({className:T("checkboxIcon")},N("checkboxIcon")),a=u.getJSXIcon(t?n.checkboxIcon||e.createElement(p,o):r?n.checkboxIcon||e.createElement(m,o):null,L({},o),n),l=E({"aria-hidden":!0,className:T("checkboxContainer")},N("checkboxContainer")),i=E({className:T("checkbox",{checked:t,partialChecked:r,nodeProps:n}),role:"checkbox"},N("checkbox"));return e.createElement("div",l,e.createElement("div",i,a))}return null},Ee=function(){var t=n.node.icon||(D?n.node.expandedIcon:n.node.collapsedIcon);if(t){var r=E({className:c(t,T("nodeIcon"))},N("nodeIcon"));return e.createElement("span",r)}return null},ke=function(){var t=E({className:T("togglerIcon"),"aria-hidden":!0},N("togglerIcon")),r=u.getJSXIcon(D?n.collapseIcon||e.createElement(f,t):n.expandIcon||e.createElement(g,t),L({},t),{props:n,expanded:D}),o=E({type:"button",className:T("toggler"),tabIndex:-1,"aria-hidden":!0,onClick:j},N("toggler")),a=e.createElement("button",o,r,e.createElement(y,null));n.togglerTemplate&&(a=s.getJSXElement(n.togglerTemplate,n.node,{onClick:j,containerClassName:"p-tree-toggler p-link",iconClassName:"p-tree-toggler-icon",element:a,props:n,expanded:D}));return a},Ce=function(t){if(n.dragdropScope){var r=E({className:T("droppoint"),onDrop:function(e){return se(e,t)},onDragOver:ue,onDragEnter:pe,onDragLeave:fe},N("droppoint"));return e.createElement("li",r)}return null},Ie=function(){var t=re(),r=oe(),o=ke(),a=Se(),l=Ee(),i=xe(),d=E({ref:b,className:c(n.node.className,T("content",{checked:r,selected:t,nodeProps:n,isCheckboxSelectionMode:ce})),style:n.node.style,onClick:X,onDoubleClick:B,onContextMenu:V,onTouchEnd:de,draggable:n.dragdropScope&&!1!==n.node.draggable&&!n.disabled,onDrop:ge,onDragOver:me,onDragEnter:ye,onDragLeave:he,onDragStart:ve,onDragEnd:be,"data-p-highlight":ce()?r:t},N("content"));return e.createElement("div",d,o,a,l,i)},De=(r=n.disabled||0!==n.index?-1:0,o=re(),l=oe(),i=Ie(),t=E({className:T("subgroup"),role:"group"},N("subgroup")),h=s.isNotEmpty(n.node.children)&&D?e.createElement("ul",t,n.node.children.map((function(t,r){return e.createElement(R,{key:t.key||t.label,node:t,checkboxIcon:n.checkboxIcon,collapseIcon:n.collapseIcon,contextMenuSelectionKey:n.contextMenuSelectionKey,cx:T,disabled:n.disabled,dragdropScope:n.dragdropScope,expandIcon:n.expandIcon,expandedKeys:n.expandedKeys,index:r,isNodeLeaf:n.isNodeLeaf,last:r===n.node.children.length-1,metaKeySelection:n.metaKeySelection,nodeTemplate:n.nodeTemplate,onClick:n.onClick,onCollapse:n.onCollapse,onContextMenu:n.onContextMenu,onContextMenuSelectionChange:n.onContextMenuSelectionChange,onDoubleClick:n.onDoubleClick,onDragEnd:n.onDragEnd,onDragStart:n.onDragStart,onDrop:n.onDrop,onDropPoint:n.onDropPoint,onExpand:n.onExpand,onPropagateUp:ne,onSelect:n.onSelect,onSelectionChange:n.onSelectionChange,onToggle:n.onToggle,onUnselect:n.onUnselect,originalOptions:n.originalOptions,parent:n.node,path:n.path+"-"+r,propagateSelectionDown:n.propagateSelectionDown,propagateSelectionUp:n.propagateSelectionUp,ptm:w,selectionKeys:n.selectionKeys,selectionMode:n.selectionMode,togglerTemplate:n.togglerTemplate})}))):null,v=E(O(O({ref:x,className:c(n.node.className,T("node",{isLeaf:C})),style:n.node.style,tabIndex:r,role:"treeitem","aria-label":I,"aria-level":n.level,"aria-expanded":D,"aria-checked":l,"aria-setsize":n.node.children?n.node.children.length:0,"aria-posinset":n.index+1,onKeyDown:_},"aria-expanded",D),"aria-selected",l||o),N("node")),e.createElement("li",v,i,h));if(n.dragdropScope&&!n.disabled){var Oe=Ce(-1),we=n.last?Ce(1):null;return e.createElement(e.Fragment,null,Oe,De,we)}return De}));function F(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function J(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?F(Object(t),!0).forEach((function(n){O(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function X(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=B(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return l=e.done,e},e:function(e){i=!0,a=e},f:function(){try{l||null==t.return||t.return()}finally{if(i)throw a}}}}function B(e,n){if(e){if("string"==typeof e)return V(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?V(e,n):void 0}}function V(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}R.displayName="UITreeNode";var _=e.memo(e.forwardRef((function(r,p){var f=a(),g=e.useContext(n),m=M.getProps(r,g),y=K(e.useState(""),2),v=y[0],b=y[1],x=K(e.useState(m.expandedKeys),2),S=x[0],E=x[1],C=e.useRef(null),I=e.useRef([]),D=e.useRef(null),O=e.useRef(!1),w=m.onFilterValueChange?m.filterValue:v,T=m.onToggle?m.expandedKeys:S,N=e.useRef(null),P=M.setMetaData({props:m,state:{filterValue:w,expandedKeys:T}}),j=P.ptm,A=P.cx;o(M.css.styles,P.isUnstyled,{name:"tree"});var U,L,F,B={filter:function(e){return te(e)},reset:function(){return ie()}},V=function(e){var n=e.originalEvent,t=e.value,r=e.navigateFocusToChild;m.onToggle?m.onToggle({originalEvent:n,value:t}):(r&&(N.current=n),E(t))};U=function(){if(N.current){var e=N.current,n="toggler"===e.target.getAttribute("data-pc-section")?e.target.closest('[role="treeitem"]'):e.target,t=n.children[1].children[0];n.tabIndex="-1",t.tabIndex="0",t.focus(),N.current=null}},L=[T],F=e.useRef(!1),e.useEffect((function(){if(F.current)return U&&U();F.current=!0}),L);var _=function(e){D.current={path:e.path,index:e.index}},H=function(){D.current=null},$=function e(n){if(Array.isArray(n))return n.map(e);if(n&&Object.getPrototypeOf(n)===Object.prototype){var t={};for(var r in n)t[r]="data"!==r?e(n[r]):n[r];return t}return n},z=function(e){if(G(D.current.path,e.path)){var n=$(m.value),t=D.current.path.split("-");t.pop();var r=Z(n,t),o=r?r.children[D.current.index]:n[D.current.index],a=Z(n,e.path.split("-"));a.children?a.children.push(o):a.children=[o],r?r.children.splice(D.current.index,1):n.splice(D.current.index,1),m.onDragDrop&&m.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:o,dropNode:a,dropIndex:e.index})}},Y=function(e){if(Q(e)){var n=$(m.value),t=D.current.path.split("-");t.pop();var r=e.path.split("-");r.pop();var o=Z(n,t),a=Z(n,r),l=o?o.children[D.current.index]:n[D.current.index],i=W(D.current.path,e.path);if(o?o.children.splice(D.current.index,1):n.splice(D.current.index,1),e.position<0){var c=i?D.current.index>e.index?e.index:e.index-1:e.index;a?a.children.splice(c,0,l):n.splice(c,0,l)}else a?a.children.push(l):n.push(l);m.onDragDrop&&m.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:l,dropNode:a,dropIndex:e.index})}},q=function(e,n){return!!e&&(e!==n&&0!==n.indexOf(e))},G=function(e,n){return!!q(e,n)&&!(e.indexOf("-")>0&&e.substring(0,e.lastIndexOf("-"))===n)},Q=function(e){return!!q(D.current.path,e.path)&&(-1!==e.position||!W(D.current.path,e.path)||D.current.index+1!==e.index)},W=function(e,n){return 1===e.length&&1===n.length||e.substring(0,e.lastIndexOf("-"))===n.substring(0,n.lastIndexOf("-"))},Z=function e(n,t){if(0===t.length)return null;var r=parseInt(t[0],10),o=n.children?n.children[r]:n[r];return 1===t.length?o:(t.shift(),e(o,t))},ee=function(e){return!1!==e.leaf&&!(e.children&&e.children.length)},ne=function(e){13===e.which&&e.preventDefault()},te=function(e){O.current=!0;var n=e.target.value;m.onFilterValueChange?m.onFilterValueChange({originalEvent:e,value:n}):b(n)},re=function(e){b(s.isNotEmpty(e)?e:""),oe()},oe=function(){if(O.current){if(s.isEmpty(w))I.current=m.value;else{I.current=[];var e,n=m.filterBy.split(","),t=w.toLocaleLowerCase(m.filterLocale),r="strict"===m.filterMode,o=X(m.value);try{for(o.s();!(e=o.n()).done;){var a=J({},e.value),l={searchFields:n,filterText:t,isStrictMode:r};(r&&(ae(a,l)||le(a,l))||!r&&(le(a,l)||ae(a,l)))&&I.current.push(a)}}catch(e){o.e(e)}finally{o.f()}}O.current=!1}},ae=function(e,n){if(e){var t=!1;if(e.children){var r=k(e.children);e.children=[];var o,a=X(r);try{for(a.s();!(o=a.n()).done;){var l=J({},o.value);le(l,n)&&(t=!0,e.children.push(l))}}catch(e){a.e(e)}finally{a.f()}}if(t)return e.expanded=!0,!0}},le=function(e,n){var t,r=n.searchFields,o=n.filterText,a=n.isStrictMode,l=!1,i=X(r);try{for(i.s();!(t=i.n()).done;){String(s.resolveFieldData(e,t.value)).toLocaleLowerCase(m.filterLocale).indexOf(o)>-1&&(l=!0)}}catch(e){i.e(e)}finally{i.f()}return(!l||a&&!ee(e))&&(l=ae(e,{searchFields:r,filterText:o,isStrictMode:a})||l),l},ie=function(){b("")};e.useImperativeHandle(p,(function(){return{props:m,filter:re,getElement:function(){return C.current}}}));var ce=function(n,t,r){return e.createElement(R,{hostName:"Tree",key:n.key||n.label,node:n,level:m.level+1,originalOptions:m.value,index:t,last:r,path:String(t),checkboxIcon:m.checkboxIcon,collapseIcon:m.collapseIcon,contextMenuSelectionKey:m.contextMenuSelectionKey,cx:A,disabled:m.disabled,dragdropScope:m.dragdropScope,expandIcon:m.expandIcon,expandedKeys:T,isNodeLeaf:ee,metaKeySelection:m.metaKeySelection,nodeTemplate:m.nodeTemplate,onClick:m.onNodeClick,onCollapse:m.onCollapse,onContextMenu:m.onContextMenu,onContextMenuSelectionChange:m.onContextMenuSelectionChange,onDoubleClick:m.onNodeDoubleClick,onDragEnd:H,onDragStart:_,onDrop:z,onDropPoint:Y,onExpand:m.onExpand,onSelect:m.onSelect,onSelectionChange:m.onSelectionChange,onToggle:V,onUnselect:m.onUnselect,propagateSelectionDown:m.propagateSelectionDown,propagateSelectionUp:m.propagateSelectionUp,ptm:j,selectionKeys:m.selectionKeys,selectionMode:m.selectionMode,togglerTemplate:m.togglerTemplate})},de=function(n){var t=f(J({className:c(m.contentClassName,A("container")),role:"tree","aria-label":m.ariaLabel,"aria-labelledby":m.ariaLabelledBy,style:m.contentStyle},fe),j("container"));return e.createElement("ul",t,n)},se=function(e){return e.map((function(n,t){return ce(n,t,t===e.length-1)}))},ue=function(){if(m.filter){var n=s.isNotEmpty(w)?w:"",t=f({className:A("searchIcon")},j("searchIcon")),r=u.getJSXIcon(m.filterIcon||e.createElement(l,t),J({},t),{props:m}),o=f({className:A("filterContainer")},j("filterContainer")),a=f({type:"text",value:n,autoComplete:"off",className:A("input"),placeholder:m.filterPlaceholder,"aria-label":m.filterPlaceholder,onKeyDown:ne,onChange:te,disabled:m.disabled},j("input")),i=e.createElement("div",o,e.createElement("input",a),r);if(m.filterTemplate)i=s.getJSXElement(m.filterTemplate,{className:"p-tree-filter-container",element:i,filterOptions:B,filterInputKeyDown:ne,filterInputChange:te,filterIconClassName:"p-dropdown-filter-icon",props:m});return e.createElement(e.Fragment,null,i)}return null},pe=M.getOtherProps(m),fe=s.reduceKeys(pe,d.ARIA_PROPS),ge=function(){if(m.loading){var n=f({className:A("loadingIcon")},j("loadingIcon")),t=m.loadingIcon||e.createElement(i,h({},n,{spin:!0})),r=u.getJSXIcon(t,J({},n),{props:m}),o=f({className:A("loadingOverlay")},j("loadingOverlay"));return e.createElement("div",o,r)}return null}(),me=function(){if(m.value){m.filter&&(O.current=!0,oe());var n=m.filter&&I.current?I.current:m.value;if(n.length>0){var r=se(n);return de(r)}var o=(a=f({className:c(m.contentClassName,A("emptyMessage"))},j("emptyMessage")),l=s.getJSXElement(m.emptyMessage,m)||t("emptyMessage"),e.createElement("li",a,e.createElement("span",{className:"p-treenode-content"},l)));return de(o)}var a,l;return null}(),ye=function(){if(m.showHeader){var n=ue(),t=n;if(m.header)t=s.getJSXElement(m.header,{filterContainerClassName:"p-tree-filter-container",filterIconClassName:"p-tree-filter-icon",filterInput:{className:"p-tree-filter p-inputtext p-component",onKeyDown:ne,onChange:te},filterElement:n,element:t,props:m});var r=f({className:A("header")},j("header"));return e.createElement("div",r,t)}return null}(),he=function(){var n=s.getJSXElement(m.footer,m),t=f({className:A("footer")},j("footer"));return e.createElement("div",t,n)}(),ve=f({ref:C,className:c(m.className,A("root")),style:m.style,id:m.id},M.getOtherProps(m),j("root"));return e.createElement("div",ve,ge,ye,me,he)})));_.displayName="Tree";export{_ as Tree};
