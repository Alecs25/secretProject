import*as e from"react";import{PrimeReactContext as r}from"primereact/api";import{ComponentBase as n,useHandleStyle as t}from"primereact/componentbase";import{useMergeProps as o,useMountEffect as l,useUnmountEffect as a}from"primereact/hooks";import{classNames as c,UniqueComponentId as i,DomHandler as s}from"primereact/utils";function u(){return u=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},u.apply(this,arguments)}function p(e){if(Array.isArray(e))return e}function d(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,o,l,a,c=[],i=!0,s=!1;try{if(l=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;i=!1}else for(;!(i=(t=l.call(n)).done)&&(c.push(t.value),c.length!==r);i=!0);}catch(e){s=!0,o=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}function f(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function m(e,r){if(e){if("string"==typeof e)return f(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,r):void 0}}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e,r){return p(e)||d(e,r)||m(e,r)||h()}var b=n.extend({defaultProps:{__TYPE:"ScrollPanel",id:null,style:null,className:null,children:void 0,step:5},css:{classes:{root:function(e){return c("p-scrollpanel p-component",e.props.className)},wrapper:"p-scrollpanel-wrapper",content:"p-scrollpanel-content",barx:"p-scrollpanel-bar p-scrollpanel-bar-x",bary:"p-scrollpanel-bar p-scrollpanel-bar-y"},styles:"\n        @layer primereact {\n            .p-scrollpanel-wrapper {\n                overflow: hidden;\n                width: 100%;\n                height: 100%;\n                position: relative;\n                z-index: 1;\n                float: left;\n            }\n\n            .p-scrollpanel-content {\n                height: calc(100% + 18px);\n                width: calc(100% + 18px);\n                padding: 0 18px 18px 0;\n                position: relative;\n                overflow: auto;\n                box-sizing: border-box;\n            }\n\n            .p-scrollpanel-bar {\n                position: relative;\n                background: #c1c1c1;\n                border-radius: 3px;\n                z-index: 2;\n                cursor: pointer;\n                opacity: 0;\n                transition: opacity 0.25s linear;\n            }\n\n            .p-scrollpanel-bar-y {\n                width: 9px;\n                top: 0;\n            }\n\n            .p-scrollpanel-bar-x {\n                height: 9px;\n                bottom: 0;\n            }\n\n            .p-scrollpanel-hidden {\n                visibility: hidden;\n            }\n\n            .p-scrollpanel:hover .p-scrollpanel-bar,\n            .p-scrollpanel:active .p-scrollpanel-bar {\n                opacity: 1;\n            }\n\n            .p-scrollpanel-grabbed {\n                user-select: none;\n            }\n        }\n        "}}),g=e.forwardRef((function(n,c){var p=o(),d=e.useContext(r),f=b.getProps(n,d),m=v(e.useState(f.id),2),h=m[0],g=m[1],y=v(e.useState("vertical"),2),w=y[0],x=y[1],A=b.setMetaData({props:f}),E=A.ptm,C=A.cx;t(b.css.styles,A.isUnstyled,{name:"scrollpanel"});var L=e.useRef(null),R=e.useRef(null),S=e.useRef(null),D=e.useRef(null),T=v(e.useState(0),2),z=T[0],F=T[1],N=v(e.useState(0),2),H=N[0],I=N[1],O=e.useRef(!1),j=e.useRef(!1),M=e.useRef(null),P=e.useRef(null),k=e.useRef(null),B=e.useRef(null),U=e.useRef(null),W=e.useRef(!1),Y=e.useRef(null),K=h+"_content",X=function(){var e=R.current.scrollWidth,r=-1*(L.current.clientHeight-S.current.clientHeight);k.current=R.current.clientWidth/e;var n=R.current.scrollHeight,t=-1*(L.current.clientWidth-D.current.clientWidth);B.current=R.current.clientHeight/n,U.current=window.requestAnimationFrame((function(){k.current>=1?s.addClass(S.current,"p-scrollpanel-hidden"):(s.removeClass(S.current,"p-scrollpanel-hidden"),S.current.style.cssText="width:"+Math.max(100*k.current,10)+"%; left:"+R.current.scrollLeft/e*100+"%;bottom:"+r+"px;"),B.current>=1?s.addClass(D.current,"p-scrollpanel-hidden"):(s.removeClass(D.current,"p-scrollpanel-hidden"),D.current.style.cssText="height:"+Math.max(100*B.current,10)+"%; top: calc("+R.current.scrollTop/n*100+"% - "+S.current.clientHeight+"px);right:"+t+"px;")}))},q=function(e){S.current.isSameNode(e.target)?x("horizontal"):D.current.isSameNode(e.target)&&x("vertical")},_=function(){"horizontal"===w&&x("vertical")},$=function(e){O.current?G(e):(j.current||G(e),J(e))},G=function(e){var r=e.pageX-M.current;M.current=e.pageX,U.current=window.requestAnimationFrame((function(){R.current.scrollLeft+=r/k.current}))},J=function(e){var r=e.pageY-P.current;P.current=e.pageY,U.current=window.requestAnimationFrame((function(){R.current.scrollTop+=r/B.current}))},Q=function e(r){s.removeClass(D.current,"p-scrollpanel-grabbed"),s.removeClass(S.current,"p-scrollpanel-grabbed"),s.removeClass(document.body,"p-scrollpanel-grabbed"),document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",e),O.current=!1,j.current=!1},V=function(e){if("vertical"===w)switch(e.code){case"ArrowDown":re("scrollTop",f.step),e.preventDefault();break;case"ArrowUp":re("scrollTop",-1*f.step),e.preventDefault();break;case"ArrowLeft":case"ArrowRight":e.preventDefault()}else if("horizontal"===w)switch(e.code){case"ArrowRight":re("scrollLeft",f.step),e.preventDefault();break;case"ArrowLeft":re("scrollLeft",-1*f.step),e.preventDefault();break;case"ArrowDown":case"ArrowUp":e.preventDefault()}},Z=function(){ne()},ee=function(e,r){R.current[e]+=r,X()},re=function(e,r){ne(),Y.current=setTimeout((function(){ee(e,r)}),40)},ne=function(){Y.current&&clearTimeout(Y.current)},te=function(){X()};l((function(){var e,r,n;f.id||g(i()),X(),window.addEventListener("resize",X),e=getComputedStyle(L.current),r=getComputedStyle(S.current),n=s.getHeight(L.current)-parseInt(r.height,10),"none"!==e["max-height"]&&0===n&&(L.current.style.height=R.current.offsetHeight+parseInt(r.height,10)>parseInt(e["max-height"],10)?e["max-height"]:R.current.offsetHeight+parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)+"px"),W.current=!0})),a((function(){W.current&&window.removeEventListener("resize",X),U.current&&window.cancelAnimationFrame(U.current)})),e.useImperativeHandle(c,(function(){return{props:f,refresh:te,getElement:function(){return L.current},getContent:function(){return R.current},getXBar:function(){return S.current},getYBar:function(){return D.current}}}));var oe=p({id:f.id,ref:L,style:f.style,className:C("root")},b.getOtherProps(f),E("root")),le=p({className:C("wrapper")},E("wrapper")),ae=p({className:C("content"),onScroll:function(e){z!==e.target.scrollLeft?(F(e.target.scrollLeft),x("horizontal")):H!==e.target.scrollTop&&(I(e.target.scrollTop),x("vertical")),X()},onMouseEnter:X},E("content")),ce=p({ref:S,role:"scrollbar",className:C("barx"),tabIndex:0,"aria-valuenow":H,"aria-controls":K,"aria-orientation":"horizontal",onFocus:q,onBlur:_,onKeyDown:V,onKeyUp:Z,onMouseDown:function(e){O.current=!0,M.current=e.pageX,s.addClass(S.current,"p-scrollpanel-grabbed"),s.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",$),document.addEventListener("mouseup",Q),e.preventDefault()}},E("barx")),ie=p({ref:D,role:"scrollbar",className:C("bary"),tabIndex:0,"aria-valuenow":z,"aria-controls":K,"aria-orientation":"vertical",onFocus:q,onBlur:_,onKeyDown:V,onKeyUp:Z,onMouseDown:function(e){j.current=!0,P.current=e.pageY,s.addClass(D.current,"p-scrollpanel-grabbed"),s.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",$),document.addEventListener("mouseup",Q),e.preventDefault()}},E("bary"));return e.createElement("div",oe,e.createElement("div",le,e.createElement("div",u({ref:R},ae),f.children)),e.createElement("div",ce),e.createElement("div",ie))}));g.displayName="ScrollPanel";export{g as ScrollPanel};
